%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


parfor i=1:N
    if inpolygon(X,Y,C{i}(1,:),C{i}(2,:))
        xm(i)=X(i);
        ym(i)=Y(i);
    else
        dist=(C{i}(1,:)-X(i)).^2+(C{i}(2,:)-Y(i)).^2;
        w=find(dist==min(dist));
        xm(i)=C{i}(1,w);
        ym(i)=C{i}(2,w);
    end
    [xv,yv]=meshgrid(C{i}(1,:),C{i}(2,:));
    inpolygon(xv,yv,C{i}(1,:),C{i}(2,:))
end



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%